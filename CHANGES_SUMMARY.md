# –†–µ–∑—é–º–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. ‚úÖ –û—à–∏–±–∫–∞ telegram.error.Conflict
**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–æ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–ª—Å—è —Å –æ—à–∏–±–∫–æ–π "Conflict: terminated by other getUpdates request"

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ Conflict –≤ `telegram_bot/bot.py`
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –±–æ—Ç –≤—ã–≤–æ–¥–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ —Å –ø—Ä–∏—á–∏–Ω–∞–º–∏ –∏ —Ä–µ—à–µ–Ω–∏—è–º–∏
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –±–µ–∑ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö —Ä–µ—Å—Ç–∞—Ä—Ç–æ–≤ (`sys.exit(1)`)
- –î–æ–±–∞–≤–ª–µ–Ω `drop_pending_updates=True` –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ —Å—Ç–∞—Ä—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

### 2. ‚úÖ Graceful Shutdown
**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ SIGINT –∏ SIGTERM
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –±–æ—Ç–∞ –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

### 3. ‚úÖ –ö–æ–º–∞–Ω–¥–∞ /profile
**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–º–∞–Ω–¥–∞ –Ω–µ –æ—Ç–≤–µ—á–∞–ª–∞

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å try-except
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤
- –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 4. ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥ (/start, /profile, /new_dialog)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∫–Ω–æ–ø–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã)
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞ —Å –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º
- DEBUG-–ª–æ–≥–∏ –¥–ª—è –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫ (NetworkError, TimedOut)

### 5. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
**–û–±–Ω–æ–≤–ª—ë–Ω README.md:**
- –†–∞–∑–¥–µ–ª "–û—Ç–ª–∞–¥–∫–∞ –∏ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º"
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ Conflict –∏ –µ—ë —Ä–µ—à–µ–Ω–∏–π
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

## –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### telegram_bot/bot.py
**–°—Ç—Ä–æ–∫–∏ —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏:**
- 1-16: –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã (sys, signal, Conflict, NetworkError, TimedOut)
- 50-54: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã /start
- 110-134: –£–ª—É—á—à–µ–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ /profile —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
- 167-177: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ handle_text
- 205-286: –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è run_bot() —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫

**–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
```python
# –û–±—Ä–∞–±–æ—Ç–∫–∞ Conflict
except Conflict as e:
    logger.error("–û–®–ò–ë–ö–ê: –ü–æ–ª—É—á–µ–Ω Conflict –æ—Ç Telegram API")
    logger.error("–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã: ...")
    sys.exit(1)

# Graceful shutdown
def signal_handler(sig, frame):
    logger.info("–ü–æ–ª—É—á–µ–Ω —Å–∏–≥–Ω–∞–ª –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è...")
    application.stop()
    sys.exit(0)

signal.signal(signal.SIGINT, signal_handler)
signal.signal(signal.SIGTERM, signal_handler)

# –£–ª—É—á—à–µ–Ω–Ω—ã–π polling
application.run_polling(
    drop_pending_updates=True,
    allowed_updates=Update.ALL_TYPES,
)
```

### README.md
**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –†–∞–∑–¥–µ–ª "–û—Ç–ª–∞–¥–∫–∞ –∏ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º" (—Å—Ç—Ä–æ–∫–∏ 154-251)
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞ (—Å—Ç—Ä–æ–∫–∏ 80-105)
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (—Å—Ç—Ä–æ–∫–∏ 107-123)
- –†–∞–∑–¥–µ–ª "–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è" (—Å—Ç—Ä–æ–∫–∏ 253-262)

## –ß—Ç–æ –ù–ï –∏–∑–º–µ–Ω–µ–Ω–æ

‚úÖ **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞:**
- –¢–∞—Ä–∏—Ñ—ã: 100 –∑–∞–ø—Ä–æ—Å–æ–≤ / 30 –¥–Ω–µ–π / 1500 ‚ÇΩ
- –°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –∫–æ–¥—ã (`/start –ö–û–î`)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –∏ –¥–∞—Ç –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å NAVIGATOR_SERVER_URL
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (SQLite/PostgreSQL)
- –í—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –ø—Ä–µ–∂–¥–µ

## –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
python -m telegram_bot

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ - –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
# ============================================================
# NAVIGATOR Telegram bot starting...
# Polling mode enabled
# Bot token: ...–ø–æ—Å–ª–µ–¥–Ω–∏–µ_—Å–∏–º–≤–æ–ª—ã
# ============================================================
```

–í Telegram:
- `/start` - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
- `/profile` - –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
- –ö–Ω–æ–ø–∫–∞ "üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å" - –≤—ã–∑–æ–≤ /profile
- –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –∏ –≤—ã–∑–æ–≤ NAVIGATOR

### 2. –î–µ–ø–ª–æ–π –Ω–∞ Railway

**–í–∞–∂–Ω–æ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º:**
1. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∑–∞–ø—É—â–µ–Ω–∞ **—Ç–æ–ª—å–∫–æ 1 —Ä–µ–ø–ª–∏–∫–∞**:
   ```
   Railway ‚Üí Settings ‚Üí Deploy ‚Üí Replicas: 1
   ```

2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   - `TELEGRAM_BOT_TOKEN` ‚úì
   - `NAVIGATOR_SERVER_URL` ‚úì
   - `NAVIGATOR_FRAMEWORK_NAME` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:**
```bash
# –°–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
railway logs

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –Ω–µ—Ç Conflict
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏ –æ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞ –±–µ–∑ –æ—à–∏–±–æ–∫
```

### 3. –ï—Å–ª–∏ Conflict –≤—Å—ë –µ—â—ë –≤–æ–∑–Ω–∏–∫–∞–µ—Ç

**–ß–µ–∫-–ª–∏—Å—Ç:**
- [ ] –ë–æ—Ç –ù–ï –∑–∞–ø—É—â–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ
- [ ] –ù–∞ Railway —Ç–æ–ª—å–∫–æ 1 —Ä–µ–ø–ª–∏–∫–∞
- [ ] –ù–µ—Ç –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ —Å —ç—Ç–∏–º —Ç–æ–∫–µ–Ω–æ–º
- [ ] –°—Ç–∞—Ä—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã

**–†–∞–¥–∏–∫–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**
1. –ù–∞–ø–∏—Å–∞—Ç—å @BotFather
2. `/revoke` ‚Üí –≤—ã–±—Ä–∞—Ç—å –±–æ—Ç–∞
3. `/token` ‚Üí –ø–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
4. –û–±–Ω–æ–≤–∏—Ç—å `TELEGRAM_BOT_TOKEN` –Ω–∞ Railway

## Pull Request

**–í–µ—Ç–∫–∞:** `claude/fix-telegram-conflict-profile-01SYpjkxfUcZEkD7Ttw8amND`

**–°–æ–∑–¥–∞—Ç—å PR:**
1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ GitHub: https://github.com/Elhan1505/navigator-telegram-bot/pull/new/claude/fix-telegram-conflict-profile-01SYpjkxfUcZEkD7Ttw8amND

2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑ —Ñ–∞–π–ª–∞ `PR_DESCRIPTION.md`

3. –ò–ª–∏ —Å–æ–∑–¥–∞—Ç—å –≤—Ä—É—á–Ω—É—é:
   - Title: "–ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫—É telegram.error.Conflict –∏ —É–ª—É—á—à–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –±–æ—Ç–∞"
   - Description: —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ `PR_DESCRIPTION.md`

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**Commit:** dd036f2
**–§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ:** 2
- telegram_bot/bot.py (+220 —Å—Ç—Ä–æ–∫, -25 —Å—Ç—Ä–æ–∫)
- README.md (+120 —Å—Ç—Ä–æ–∫, -15 —Å—Ç—Ä–æ–∫)

**–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:** ~30 –º–∏–Ω—É—Ç
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –∏ –º–µ—Ä–∂—É
